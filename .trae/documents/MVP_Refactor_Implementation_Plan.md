## 阿斯汤加打卡 App MVP 重构方案

### 1. 核心目标
将应用重构为“纯本地、无后端”版本，通过“假门测试”验证核心功能需求，并优化移动端计时与录入体验。

### 2. 实施步骤

#### 第一阶段：基础设施与环境准备
1. **安装依赖**: 安装 `uuid`, `mixpanel-browser`, `react-use` 等必要库。
2. **埋点服务 (`lib/analytics.ts`)**: 封装 Mixpanel 初始化及事件追踪逻辑。
3. **本地存储核心 (`hooks/usePracticeData.ts`)**: 编写自定义 Hook，实现 `practice_records`、`user_profiles` 和 `practice_options` 的 LocalStorage CRUD 操作，确保数据结构与原 Supabase 一致。

#### 第二阶段：假门测试与 UI 组件
1. **统一弹窗 (`components/FakeDoorModal.tsx`)**: 实现包含“云同步”与“Pro会员”两种模式的投票弹窗，包含心理学暗示文案。
2. **状态持久化**: 实现投票状态的本地记忆（红变绿、按钮禁用、数字+1）。

#### 第三阶段：页面深度重构 (`app/page.tsx` & `app/layout.tsx`)
1. **数据源替换**: 彻底移除 Supabase 引用，接入 `usePracticeData`。
2. **计时器升级**:
    *   改为基于时间戳差值计算，解决后台/锁屏计时不准问题。
    *   实现计时状态 LocalStorage 持久化。
    *   UI 优化：增加秒级显示，缩小主按钮，整体上移适配移动端。
3. **录入与展示优化**:
    *   **时间轴**: 缩小字号与间距，移除图片占位。
    *   **录入页**: “时长”与“突破”开关并排，按需展开详情。
    *   **设置页**: 隐藏账号绑定，激活真实的 JSON 导入/导出功能。
4. **交互反馈**: 增加提交防抖保护，完善打卡/补卡成功的 Toast 提示。

### 3. 验证方案
1. 检查 LocalStorage 是否正确生成 UUID 和练习数据。
2. 验证锁屏/后台运行后计时器是否依然准确。
3. 测试导入/导出功能是否能成功恢复数据。
4. 验证点击假门测试后，埋点是否成功触发且 UI 状态正确持久化。

请确认是否按照此计划执行？确认后我将开始第一步：安装依赖。