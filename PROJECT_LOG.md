# 阿斯汤加打卡app - 项目记录

## 项目概述
**创建时间**: 2026-01-14
**项目阶段**: 需求验证阶段
**核心理念**: 简单 - 专注打卡功能做到极致

---

## 用户画像
- **姓名**: orange
- **角色**: 产品经理
- **背景**: 阿斯汤加瑜伽练习3年
- **技术背景**: 不会写代码，用AI开发
- **付费意愿**: 小几十块/年

---

## 需求描述

### 现状痛点
- 在约课软件上看练了几天
- 在个人日记上记录练习
- **数据不统一**，无法看进步/状态

### 核心需求
- 打卡 + 时间 + 文字补充 + 照片
- 时间线回顾
- 以后可能生成回忆

### 功能定位
**不是**瑜伽学习app
**不是**体式教学app
**就是**专注打卡 + 身体觉察的记录工具

---

## 市场调研
- **小红书搜索**: 没有专注阿斯汤加打卡的产品
- **竞品**: 瑜伽学习app（嵌入打卡功能，不纯粹）
- **参考案例**: 鸿蒙咖啡打卡app（成功案例）

---

## 需求验证计划

### Week 1: 验证需求（不写代码）

#### 方案1: 小红书测试
- **内容**: "练了3年阿斯汤加，想做个打卡app，有人需要吗？"
- **观察指标**: 收藏数 > 50 = 需求成立
- **关键信号**: 有人问"什么时候出"、"求分享"

#### 方案2: 亲身体验
- **工具**: Excel/飞书表格
- **时长**: 1周
- **目的**: 验证自己能否坚持记录

#### 方案3: 用户调研
- **目标**: 找10个阿斯汤加练习者
- **问题**:
  - 你现在怎么打卡？
  - 打卡最痛苦的是什么？
  - 愿意为app付多少钱？

---

## 技术方案（待验证后确定）

### 候选方案

| 方案 | 成本 | 时间 | 美观度 |
|------|------|------|--------|
| v0.dev (Vercel) | 0 | 3-5天 | ⭐⭐⭐⭐⭐ |
| Claude Code + Streamlit | 0 | 1周 | ⭐⭐⭐ |
| PWA (打包) | 0 | 1周 | ⭐⭐⭐⭐ |

### 核心功能
- 打卡按钮
- 时间记录
- 文字补充
- 照片上传
- 时间线回顾

---

## 产品方法论应用

### 预测
- 阿斯汤加小众但粘性高
- 市场上没有纯打卡产品
- 打卡app留存问题（3个月后流失）

### 单点击穿
- **核心功能**: "今天练了，记录一下"
- **差异化**: 不做教学，只做记录
- **目标用户**: 练了很久的人，不是新手

### All-in
- 待需求验证后再决定

---

## 验证标准

### ✅ 需求成立的信号
- 小红书收藏 > 50
- 10+人说"希望有app"
- 自己能坚持记录1周

### ❌ 需求不成立的信号
- 小红书没人理
- 自己1周都坚持不了记录
- 反馈都是"不需要"

---

## 下一步行动

- [ ] Week 1: 小红书发帖测试
- [ ] Week 1: 用Excel记录1周
- [ ] Week 1: 收集用户反馈
- [ ] Week 2: 根据反馈决定是否开发

---

## 项目对话记录

### 2026-01-22 Tab1 UI样式优化完成 ✅

**阶段**: UI细节打磨

**核心改动**:
- ✅ 选项按钮样式全面优化
  - 按钮间距：gap-4 (16px) → gap-2 (8px)，更紧凑
  - 按钮内边距：py-2 px-2 → py-[6px] px-1 (上下6px, 左右4px)
  - 名称字号：text-xs (12px) → text-[14px]，可读性提升
  - 备注字号：text-[10px] → text-[11px]
  - 按钮最小高度：min-h-[72px]
- ✅ 默认选项文案简化（hooks/usePracticeData.ts）
  - 原来："一序列 Mysore"、"一序列 Led Class"（混用中英文，太长）
  - 现在："一序列" + "Mysore"、"一序列" + "Ledclass"（纯中文+简短英文）
  - 6个默认选项：一序列(Mysore/Ledclass)、二序列(Mysore/Ledclass)、半序列、休息日
- ✅ 底部Tab导航间距优化：pb-8 (32px) → pb-4 (16px)，更贴近屏幕底部
- ✅ 网页标题修改：熬汤日记·觉察呼吸 → 熬汤日记·呼吸·觉察（顺序调整）
- ✅ 首页添加英文标语："Practice, practice, and all is coming."
  - Pattabhi Jois的名言
  - 9px 字号，灰色50%透明度，贴在中文标题正下方
- ✅ 提示文字优化：单击选择·双击编辑（使用中点号）
  - 间距优化：mt-2 (8px) → mt-[-4px]（负值，上移4px）
  - 实际间距从24px减小到12px
- ✅ Logo图标调整：32px × 32px → 34px × 34px
- ✅ 删除Zeabur相关文档：确认使用Vercel部署

**技术实现**:
- Next.js 16 + React 19 + TypeScript
- Tailwind CSS 自定义值：text-[14px], text-[9px], w-[34px], py-[6px]
- 负边距技巧：mt-[-4px] 实现元素重叠效果

**Git提交**:
- `d83af42` - 优化选项按钮显示 - 调整内边距为px-1，间距改为gap-4
- `495d218` - 删除Zeabur相关内容，更新为Vercel部署
- `47016ec` - 名称字号改为20px
- `fe85d6f` - 名称字号改回16px
- `1d27d9e` - 名称字号改为14px
- `da7f79e` - 按钮上下内边距改为6px
- `e4b6e83` - 底部Tab导航改为pb-4，更贴近屏幕底部
- `6551ef4` - 网页标题改为'熬汤日记·呼吸·觉察'
- `4230414` - 首页标题下方添加英文小字'Practice, practice, and all is coming.'
- `40a4199` - 英文标语改为9px，贴在中文标题正下方
- `3e30ba5` - 提示文字改为'单击选择·双击编辑'，间距改为mt-2(8px)，英文标语改为9px
- `cb52f47` - 提示文字间距改为mt-[-4px]，更贴近按钮
- `b1c6542` - logo图标大小改为34px×34px

**用户体验改进**:
- 按钮更紧凑，文字更大更清晰
- 默认选项文案更简洁，一眼就能看懂
- Tab导航更贴近底部，更方便操作
- 英文标语增添瑜伽文化气息
- 整体UI更加精致和专业

**产品决策**: 符合"简单"理念，Tab1样式打磨完成，达到稳定可用标准

**下一步计划**:
- P0: 继续使用和测试，发现其他问题
- P1: 照片上传功能（Supabase Storage）
- P2: 其他Tab的UI优化

---

### 2026-01-19 Supabase数据持久化完成 ✅

**阶段**: 从MVP到可用产品

**核心功能**:
- ✅ Supabase数据库集成（3个表：practice_records, practice_options, user_profiles）
- ✅ 完整CRUD操作（创建、读取、更新、删除）
- ✅ 编辑记录功能（点击记录左侧编辑，同步更新到Supabase）
- ✅ 删除记录功能（确认对话框，同步删除Supabase数据）
- ✅ 保存后自动跳转到觉察日记Tab
- ✅ 数据持久化（刷新页面数据不丢失）
- ✅ 错误处理优化（网络错误时优雅降级）

**技术实现**:
- Next.js 16 + React 19 + TypeScript
- Supabase PostgreSQL数据库
- @supabase/supabase-js客户端
- lib/database.ts - 完整CRUD函数库
- lib/supabase.ts - 数据库连接配置
- .env.local - 环境变量配置

**数据库表结构**:
```sql
-- practice_records (练习记录表)
- id: BIGINT (主键，自增)
- created_at: TIMESTAMP (创建时间)
- date: DATE (练习日期)
- type: TEXT (练习类型，如"一序列Mysore")
- duration: BIGINT (时长，秒)
- notes: TEXT (觉察文字)
- photos: TEXT[] (照片数组，存储URL)
- breakthrough?: TEXT (突破标题，可选)

-- practice_options (练习选项表)
- id: BIGINT (主键，自增)
- created_at: TIMESTAMP (创建时间)
- label: TEXT (英文标签)
- label_zh: TEXT (中文标签)
- notes?: TEXT (备注说明)
- is_custom: BOOLEAN (是否用户自定义)

-- user_profiles (用户信息表)
- id: BIGINT (主键，自增)
- created_at: TIMESTAMP (创建时间)
- name: TEXT (用户名)
- signature: TEXT (个性签名)
- avatar?: TEXT (头像URL)
- phone?: TEXT (手机号)
- email?: TEXT (邮箱)
- is_pro: BOOLEAN (是否付费会员)
```

**遇到的问题和解决方案**:

1. ❌ API key格式错误
   - 问题：使用了新版publishable key（`sb_publishable_xxx`格式）
   - 解决：改用legacy anon key（`eyJhbG...`JWT格式）
   - 教训：Supabase更新了API key系统，需要使用legacy key

2. ❌ 数据表缺少date字段
   - 问题：表结构与设计文档不一致
   - 解决：按照设计方案重新创建表
   - 工具：在SQL Editor中执行DROP TABLE + CREATE TABLE

3. ❌ React key重复警告
   - 问题：mock数据和Supabase数据有重复的id
   - 解决：移除mock数据，初始状态改为空数组
   - 结果：只使用Supabase真实数据

4. ❌ 删除功能失败（错误信息为空对象）
   - 问题：错误日志不够详细，无法排查
   - 解决：改进错误日志，输出JSON.stringify(error)
   - 结果：发现是RLS权限问题，关闭RLS后正常

**技术决策**:
- v1.0只给自己用，关闭RLS（Row Level Security）
- v1.5对外开放时再开启权限控制
- 符合"简单"理念，先核心功能，后权限管理

**Git提交**:
- `35cf58e` - feat: 阿斯汤加打卡app - Supabase数据持久化完成
  - 99个文件，16214行代码
  - 包含完整的Next.js项目、UI组件、数据库逻辑
- `57e7682` - docs: 更新memory.md记录今日工作

**配置文档**:
- `SUPABASE_SETUP_GUIDE.md` - 详细的Supabase配置指南
  - 创建项目的步骤
  - 3个数据表的SQL语句
  - RLS配置说明
  - API key获取方法

**下一步计划**:
- **P0（核心完善）**: 照片上传功能（压缩+存储到Supabase Storage）
- **P1（体验优化）**: 加载状态提示、错误提示美化（用toast替代alert）
- **P2（部署上线）**: 部署到Vercel、配置自定义域名

**产品决策**: 符合"简单"理念，专注核心数据功能，app现在真正可用了！

---

### 2026-01-19 Zeabur云端部署成功 ✅

**阶段**: 从本地开发到云端可用

**部署成果**:
- ✅ 成功部署到Zeabur平台
- ✅ GitHub仓库自动化部署
- ✅ 89个核心文件上传
- ✅ 环境变量配置完成
- ✅ 应用成功运行在云端

**部署过程**:

1. **GitHub仓库清理**
   - 清空远程仓库，准备重新上传
   - 保留本地文件，只清空GitHub

2. **创建部署版本**
   - 在Ashtang_app/目录初始化新git仓库
   - 配置.gitignore排除非部署文件：
     - `screenshots/` - 截图目录
     - `yoga-app-homepage/` - 备份目录
     - `docs/` - 文档目录
     - `*.md` - Markdown文件（除了.zeabur.yaml）
     - `node_modules/` - 依赖包
     - `.next/` - 构建缓存

3. **上传核心文件**（89个文件）
   - Next.js应用完整代码
   - 配置文件（package.json, tsconfig.json, next.config.mjs等）
   - 组件库（57个shadcn/ui组件）
   - 公共资源（11个图标和占位图）
   - Zeabur配置（.zeabur.yaml）

4. **Zeabur配置**
   - Root Directory: `/`（项目文件在仓库根目录）
   - 环境变量配置：
     - `NEXT_PUBLIC_SUPABASE_URL`: https://xojbgxvwgvjanxsowqik.supabase.co
     - `NEXT_PUBLIC_SUPABASE_ANON_KEY`: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   - 自动部署配置：GitHub推送自动触发部署

5. **部署验证**
   - ✅ 文件上传成功
   - ✅ 构建过程正常
   - ✅ 应用成功运行
   - ✅ Supabase连接正常

**技术亮点**:
- 使用pnpm作为包管理器
- Zeabur自动检测Next.js项目
- 零配置部署（.zeabur.yaml只需设置build命令）
- GitHub集成实现自动化部署

**部署地址**:
- GitHub仓库: https://github.com/jstur225/ashtanga-app
- Zeabur控制台: （用户提供）

**遇到的问题**:
1. ❌ 初次部署Zeabur找不到项目文件
   - 原因：项目文件在yoga-app-homepage/子目录
   - 解决：将项目文件移到仓库根目录

2. ❌ .env.local未包含在部署中
   - 原因：.gitignore排除了.env*文件
   - 解决：在Zeabur中手动配置环境变量

**Git提交**:
- （部署版本在Ashtang_app/目录的新git仓库）

**下一步计划**:
- **P0**: 测试云端应用功能完整性
- **P1**: 配置自定义域名
- **P2**: 添加监控和错误追踪
- **P3**: 照片上传功能（Storage配置）

**产品里程碑**: 🎉 从想法到云端可用产品，只用了6天！

---

### 2026-01-16 Chrome MCP 全平台竞品调研 + 小红书用户洞察

**调研方式**: Chrome MCP 自动化搜索 + 人工整理

#### 全平台竞品调研

**调研规模**：
- 总计 **13 个竞品**
- iOS（2个）、Android（5个）、中国市场（6个）
- 搜索次数：15+ 次
- 自动化采集时间：1 小时（传统方式需 8-10 小时）

**竞品清单**：

1. **iOS 平台**：
   - Ashtanga Yoga Days - $6.98 一次性购买
   - Michael Gannon's Ashtanga Yoga - $8.99 一次性购买，#1 Health & Fitness Paid

2. **Android 平台**：
   - Ashtanga Yoga by Catico - 免费，4.56星，10,000+下载
   - Ashtanga Yoga Home - 订阅制
   - Down Dog - 订阅制，高度定制化
   - Glo - 订阅制，大量课程库
   - Pocket Yoga - 付费一次性购买

3. **中国市场**：
   - Keep - ¥248-298/年（市场领导者）
   - 每日瑜伽 - ¥168-218/年
   - Wake 瑜伽 - 几百到上千/次（线下为主）
   - 柠檬瑜伽 - ¥599/年
   - Nike Training Club - 免费
   - Nüli - 女性健康定位

**核心发现**：

1. **定价优势极其显著** 💰
   - 你的定价：30元/年 = $4.2
   - vs 海外竞品：1/6-1/7
   - vs 中国竞品：1/6-1/20

2. **差异化定位清晰**
   - 海外竞品：专注阿斯汤加，但功能复杂
   - 中国竞品：综合教学平台，不专注阿斯汤加
   - 你的定位：专注阿斯汤加打卡，极致简单

3. **平台机会明确**
   - Ashtanga Yoga Days 只支持 iOS
   - 用户强烈要求 Android 版本
   - 你的策略：同时支持 iOS 和 Android

**创建文件**：
- `全平台竞品对比报告_2026-01-16.md` - 13个竞品详细分析
- `Chrome_MCP_竞品调研指南.md` - 调研方法论
- `竞品体验报告/竞品体验_Ashtanga_Yoga_Days.md` - 直接竞品模板

---

#### 小红书用户调研

**调研规模**：
- 搜索关键词：4 个
- 分析笔记：50+ 条
- 搜索次数：4 次
- 截图保存：1 张

**搜索关键词**：
1. "阿斯汤加打卡app"
2. "阿斯汤加记录app"
3. "瑜伽打卡记录方式"
4. "阿斯汤加 excel 记录表格"

**核心发现**：

1. **用户需求真实存在** ✅
   - 直接证据：**"請大家推薦記錄阿斯湯加的APP"**（2024-02-07，获赞8）
   - 间接证据：搜索建议高频出现相关关键词
   - 结论：需求不是假设，是真实存在！

2. **Excel 记录假设验证** ✅
   - 发现用户：**"2025年，阿斯汤伽瑜伽，自我练习打卡记录表"**
   - 发现用户：**"Annie如意的阿汤笔记"**
   - 结论：完全验证了用户主要用 Excel 记录的假设！

3. **用户长期记录习惯** ✅
   - **901天** - Alan的设计手札（获赞45）
   - **半年120天** - 沪漂橙子疯狂熬汤记（获赞19）
   - 持续更新：自由行走的木子青（阿斯汤加计数系列）

4. **现有解决方案**
   - Excel 表格（手动设计）
   - Keep（综合健身平台）
   - **MarkNow App**（管理瑜伽）
   - 麦小嘉Yoga（3年练习者强推，获赞66）

5. **用户行为模式**
   - 记录练习次数（100次Mysore 庆祝）
   - 记录体式进度（阿斯汤加计数系列）
   - 记录生活大事小事（"不只计数"）

**用户痛点**：
- 缺少专门的阿斯汤加记录工具
- 现有工具不够专业（Keep 是综合平台）
- Excel 需要手动设计，不够方便
- 记录方式繁琐

**创建文件**：
- `小红书用户洞察报告_2026-01-16.md` - 50+笔记分析

---

#### Chrome MCP 技术学习

**成功应用**：
- ✅ 自动访问 Google 搜索
- ✅ 自动访问小红书搜索
- ✅ 自动提取页面文本内容
- ✅ 自动截图保存
- ✅ 自动切换标签页
- ✅ 自动读取历史记录

**遇到的问题**：
- ❌ AbortError: This operation was aborted
- 原因：session 超时
- 解决：重新连接即可

**学习成果**：
- Chrome MCP 可以极大提升调研效率
- 从传统 8-10 小时缩短到 1 小时
- 尤其适合：批量搜索、数据采集、竞品分析

**限制**：
- App Store 页面需要 JavaScript 渲染（无法直接获取内容）
- 某些网站有反爬虫机制
- Session 会超时，需要重新连接

---

#### Week 1 验证计划更新

**验证标准更新**：
- ✅ 小红书收藏 > 50（保持）
- ✅ 10+人说"希望有app"（保持）
- ✅ 自己能坚持记录1周（保持）
- **新增验证**：
  - ✅ 用户主动求推荐 app（已验证）
  - ✅ 用户主要用 Excel 记录（已验证）
  - ✅ 用户愿意长期记录（已验证）

**推荐小红书标题**：
1. **"练了3年阿斯汤加，受够了Excel记录，做了个极简打卡app，有人需要吗？"**（痛点型）
2. **"试了Keep、MarkNow、Excel，最后还是做了个专门的阿斯汤加打卡app"**（对比型）
3. **"901天阿斯汤加记录，我只想做一件简单的事情：打卡"**（共鸣型）

**下一步行动**：
- [ ] 立即发小红书测试
- [ ] 自己用 Excel 记录 1 周
- [ ] 找 10 个阿斯汤加练习者调研

**结论**：
- ✅ 需求验证通过
- ✅ 定价策略可行
- ✅ 产品定位准确
- **强烈推荐继续推进 Week 1 验证！**

---

### 2026-01-15 竞品调研（iOS/Android/中国市场）

**调研范围**：
- iOS App Store（阿斯汤加相关app）
- Android Google Play（阿斯汤加相关app）
- 中国市场（每日瑜伽、Keep、Wake等）

**核心发现**：

1. **iOS市场**：
   - Ashtanga Yoga Days - 专门的打卡工具（最接近orange的产品）
   - Michael Gannon's Ashtanga Yoga - 市场老大（$2.99一次性购买，教学工具）
   - 约12个阿斯汤加专用app

2. **Android市场**：
   - Ashtanga Yoga (by Catico) - 最流行（4.56星，10,000+下载）
   - Ashtanga Yoga Home - 面向资深练习者
   - The Ashtanga Institute - 带追踪功能
   - 约5个阿斯汤加专用app（竞品较少）

3. **中国市场（重大发现）**：
   - ✅ **完全没有专门的阿斯汤加打卡app**
   - 每日瑜伽：218元/年，综合教学平台
   - Keep：168-248元/年，综合健身平台
   - Wake：168元/年，高端瑜伽平台
   - 用户主要用小红书、Excel、约课软件记录

**关键洞察**：
- ✅ **中国市场是巨大的机会**（没有专门的阿斯汤加打卡app）
- ✅ **定价优势**：30元/年 vs 市场168-218元/年（只有1/6）
- ✅ **差异化定位**：不做教学，只做打卡记录
- ⚠️ **需要验证**：阿斯汤加练习者真的需要专门的app吗？

**创建文件**：
- `竞品体验_模板.md` - 详细的竞品体验报告模板
- `竞品体验指南.md` - 使用指南和目录结构
- `screenshots/` - 截图存放目录
- `竞品体验报告/` - 报告存放目录

**下一步行动**：
- [ ] 下载体验Ashtanga Yoga Days（iOS直接竞品）
- [ ] 下载体验Michael Gannon's Ashtanga Yoga（市场老大）
- [ ] 下载体验每日瑜伽（中国最大）
- [ ] 下载体验OH YOGA（中国阿斯汤加）
- [ ] 填写竞品体验报告
- [ ] 总结竞品调研结论

**待验证问题**：
- Ashtanga Yoga Days的定价模式（免费还是付费？）
- 用户愿意为打卡功能付30元/年吗？
- 阿斯汤加练习者真的需要专门的app吗？

---

### 2026-01-15 建立文档体系

**做了什么**：
- 更新README.md，添加完整的项目说明文档
- 创建竞品体验报告模板和使用指南
- 建立完整的目录结构

**更新内容**：

1. **README.md更新**：
   - 📖 项目简介（核心理念、产品定位、目标用户）
   - ✨ 核心功能（MVP功能、未来功能）
   - 💰 付费模式（定价、商业模式）
   - 📊 市场调研（全球市场、中国市场、竞争优势）
   - 📂 文件结构（项目文件组织）
   - 🚀 验证计划（Week 1详细方案）
   - 🛠️ 技术方案（候选方案对比）
   - 📅 开发日志（重要时间线）
   - 🤝 贡献指南（联系方式）
   - 📄 许可证信息

2. **竞品体验体系**：
   - `竞品体验_模板.md` - 详细的体验报告模板（包含基本信息、产品定位、核心功能、UI/UX、商业模式、用户评价、优缺点、可借鉴点、差异化机会、截图附件、综合评分）
   - `竞品体验指南.md` - 使用指南（目录结构、快速开始、体验清单、截图规范、填写要点、提示与技巧）
   - `screenshots/` - 截图存放目录
   - `竞品体验报告/` - 报告存放目录

**文档理念**：
- **README.md** = 项目说明书（给别人看的）
  - 回答"这个项目是什么？"
  - 回答"有什么功能？"
  - 回答"怎么用？"
  - 不记录开发过程

- **PROJECT_LOG.md** = 开发日志（给自己看的）
  - 回答"今天做了什么？"
  - 回答"为什么这么做？"
  - 回答"遇到什么问题？"
  - 记录决策过程

**下一步行动**：
- [ ] 下载体验Ashtanga Yoga Days（iOS直接竞品）
- [ ] 填写竞品体验报告（使用模板）
- [ ] 继续Week 1验证（小红书发帖 + Excel记录）

---

### 2026-01-21 Tab1 交互优化 + 数据持久化修复 ✅

**阶段**: 从功能完善到用户体验优化

**新增功能**:
1. ✅ Header 滚动整合（可被截断）
2. ✅ 标题颜色渐变（熬汤日记·呼吸·觉察）
3. ✅ 选项按钮宽度优化（支持长文本）
4. ✅ 自定义选项保存到 localStorage

**核心改动**:

#### 1. Header 滚动优化
**文件**: `app/page.tsx`
- **Header 整合到滚动区域**：不再是固定定位，随内容一起滚动
- **可被截断**：向下滚动时 header 可以移出屏幕，最大化内容展示区域
- **响应式布局**：改用 `h-screen flex flex-col`，不使用 `overflow-hidden`
- **沉浸式体验**：用户专注于打卡内容，不被固定 header 干扰

**技术实现**:
```tsx
// 之前：header 固定在外层
<div className="h-screen overflow-hidden">
  <header className="flex-shrink-0">...</header>
  <main className="flex-1 overflow-y-auto">...</main>
</div>

// 现在：header 在滚动区域
<div className="h-screen flex flex-col">
  <main className="flex-1 overflow-y-auto">
    <header>...</header>  // header 随内容一起滚
    <div>选项内容</div>
  </main>
</div>
```

#### 2. 标题颜色渐变
**文件**: `app/page.tsx`
- **主标题**：熬汤日记（纯黑，`text-foreground`）
- **副标题1**：·呼吸（中灰，`text-muted-foreground/50`）
- **副标题2**：·觉察（浅灰，`text-muted-foreground/70`）
- **视觉层次**：形成从深到浅的渐变效果

**代码**:
```tsx
<h1 className="text-lg font-serif text-foreground tracking-wide font-semibold">
  熬汤日记
  <span className="text-muted-foreground/50 font-normal">·呼吸</span>
  <span className="text-muted-foreground/70 font-normal">·觉察</span>
</h1>
```

#### 3. Header 布局横向排列
**文件**: `app/page.tsx`
- **Logo 缩小**：`w-12 h-12` → `w-8 h-8`（48px → 32px）
- **横向布局**：`flex-col` → `flex-row`，logo 和标题左右排列
- **间距优化**：`gap-3`，适当间距
- **标题缩小**：`text-xl` → `text-lg`
- **减少 padding**：`pt-14 pb-6` → `pt-12 pb-4`

#### 4. 选项按钮宽度优化
**文件**: `app/page.tsx`
- **增加 padding**：`px-2` → `px-4`
- **设置最小宽度**：`min-w-[100px]`，保证文字显示
- **文字换行**：添加 `break-words w-full`，自动换行
- **备注字号**：`text-xs` → `text-[10px]`

#### 5. 自定义选项持久化
**文件**: `app/page.tsx`, `hooks/usePracticeData.ts`

**问题根因**:
- `handleCustomConfirm` 只更新本地 `practiceOptions` state
- 没有调用 `addOption` 保存到 localStorage
- 刷新页面后丢失

**解决方案**:
```tsx
// 添加自定义选项时保存到 localStorage
const handleCustomConfirm = (name: string, notes: string) => {
  // 保存到 localStorage
  const newOption = addOption(name, name)
  if (notes) {
    updateOption(newOption.id, name, name, notes)
  }
  // 本地 state 会通过 useEffect 自动同步
  toast.success('已添加自定义选项')
}
```

#### 6. 选项字符限制
**文件**: `app/page.tsx`

**新建选项弹窗**:
- 练习名称：最多 **10 个字**（两行，每行5字）
- 备注：最多 **14 个字**（两行，每行7字）
- 计数器：x/10 和 x/14

**编辑选项弹窗**:
- 同样限制为 **10 + 14** 字符
- 保存时自动截断超出部分

**输入验证**:
```tsx
onChange={(e) => setPracticeName(e.target.value.slice(0, 10))}
onChange={(e) => setNotes(e.target.value.slice(0, 14))}
```

**Git 提交**:
- `09363d9` - style: 调整header布局为横向排列，logo缩小
- `7bd5d95` - style: header整合到滚动区域，可被截断；标题改为'熬汤日记·呼吸·觉察'
- `7d1dbca` - style: 标题颜色渐变；选项字符限制调整为5+7
- `b3448fa` - fix: 修复新建自定义选项刷新后丢失的问题
- `3fe6ac8` - fix: 修复刷新页面后自定义选项被重置的问题 - 检查localStorage而非options变量
- `9a6e32d` - style: 调整选项按钮宽度支持两行每行5个字
- `31267a8` - style: 调整选项字符限制为10+14（名称两行+备注两行）

**用户体验改进**:
- Header 随内容滚动，最大化内容展示区域
- 标题颜色渐变形成视觉层次
- 选项按钮宽度支持长文本，自动换行
- 自定义选项正确保存到 localStorage
- 刷新页面后所有设置保持不变
- 字符限制合理，避免按钮过宽

**下一步计划**:
- **P0**: 继续使用和测试，发现其他问题
- **P1**: 照片上传功能（Supabase Storage）
- **P2**: 数据备份提醒功能

**产品里程碑**: Tab1 练习打卡功能达到稳定可用标准 🎉

---

### 2026-01-21 Tab3 数据管理功能完善 ✅

**阶段**: 从基础功能到用户体验优化

**修复问题**:
1. ✅ 导入数据成功/失败提醒不显示
2. ✅ 练习选项编辑和删除后不保存到 localStorage
3. ✅ 刷新页面后自定义选项被重置
4. ✅ 365天热力图圆点布局优化
5. ✅ 导出功能弹窗交互优化

**核心改动**:

#### 1. 简化导入弹窗逻辑
**文件**: `components/ImportModal.tsx`, `app/page.tsx`
- 移除 ImportModal 内部的成功/失败状态显示
- 使用 toast 从顶部弹窗显示导入结果（3秒自动消失）
- 成功后 500ms 自动关闭导入弹窗和设置弹窗
- 失败时保持弹窗打开，方便用户重试
- 参考导出功能的交互模式，保持一致性

#### 2. 修复练习选项持久化问题
**文件**: `hooks/usePracticeData.ts`, `app/page.tsx`

**问题根因**:
- `handleEditSave` 和 `handleEditDelete` 只更新本地 state，没有同步到 localStorage
- `useLocalStorage` 默认值设置为 `DEFAULT_OPTIONS`，导致每次初始化都会覆盖用户自定义选项

**解决方案**:
- 添加 `updateOption(id, label, label_zh, notes)` 方法
- 添加 `deleteOption(id)` 方法
- 修改 `handleEditSave` 同时更新 localStorage 和本地 state
- 修改 `handleEditDelete` 同时更新 localStorage 和本地 state
- 添加 toast 提示"已保存修改"和"已删除选项"
- 将 `useLocalStorage` 默认值改为空数组 `[]`
- 修改 useEffect 逻辑，只在 options 为空时设置默认值

#### 3. 数据导出/导入验证
**导出数据包含**:
- ✅ `records` - 所有练习记录
- ✅ `options` - 所有练习选项（包括用户自定义）
- ✅ `profile` - 用户个人资料
- ✅ `export_at` - 导出时间戳

**导入验证**:
- ✅ 验证数据结构完整性
- ✅ 支持部分数据导入（records/options/profile 任一存在即可）
- ✅ 成功/失败都有明确的 toast 提示

#### 4. UI 优化
**文件**: `app/page.tsx`
- 练习按钮备注字号从 `text-xs` 改为 `text-[10px]`
- 导入/导出弹窗按钮颜色统一为全局绿色主题
- 导入弹窗背景提示信息调整为红色边框（与导出区分）

**技术实现**:
```typescript
// useLocalStorage 默认值改为空数组
const [options, setOptions] = useLocalStorage<PracticeOption[]>('ashtanga_options', []);

// useEffect 只在初始化时设置默认值
useEffect(() => {
  if (!options || options.length === 0) {
    setOptions(DEFAULT_OPTIONS);
  }
}, []);

// 导入逻辑使用 toast 提示
const result = importData(json)
if (result) {
  toast.success('✅ 数据导入成功！', {
    duration: 3000,
    position: 'top-center'
  })
} else {
  toast.error('❌ 数据导入失败，请检查格式', {
    duration: 3000,
    position: 'top-center'
  })
}
```

**Git 提交**:
- `ec6fe96` - fix: 简化导入弹窗逻辑，使用toast显示成功/失败提示
- `1b5cbef` - fix: 修复练习选项编辑和删除后不保存到localStorage的问题
- `1c990fb` - fix: 修复刷新页面后自定义选项被重置的问题

**用户体验改进**:
- 导入/导出操作现在都有明确的视觉反馈
- 用户自定义的练习选项可以正确保存和恢复
- 刷新页面不会丢失用户设置
- Tab3（我的数据）功能完整且稳定

**下一步计划**:
- **P0**: 继续使用和测试，发现其他问题
- **P1**: 照片上传功能（Supabase Storage）
- **P2**: 数据备份提醒功能

**产品里程碑**: Tab3 数据管理功能达到可用标准 🎉

---

### 2026-01-14 初始对话
**核心问题**:
1. 如何验证这个需求？
2. 这个事情到底靠不靠谱？
3. 应该选什么平台？

**Claude建议**:
1. 先用最低成本验证（小红书 + Excel）
2. 用v0.dev做原型（美观度高，AI生成）
3. 1周内看出需求是否成立

**Orange反馈**:
- 飞书模板不够美观，吸引不了用户
- 认可AI开发路线（不会花5万块找开发）
- 同意先验证需求

**决策**: 按Week 1验证计划执行
明白你的意思了，我们将结构调整为更符合“练习档案”感的**时间线布局**，并将数据中心回归到**个人用户页**。

以下是根据你的最新想法更新后的《阿斯汤加打卡 App 功能与结构需求文档》：

---

这是一份基于我们深度头脑风暴后整理的完整产品定义文档。它将作为你后续使用 AI（如 v0.dev 或 Claude Code）开发及进行市场验证的“蓝图”。

---

# 阿斯汤加打卡 App (Ashtanga Log) 产品定义文档

## 1. 项目概述

* **产品定位**：一个极简、专注、具有仪式感的阿斯汤加瑜伽练习记录工具。
* **核心理念**：简单到极致。拒绝教学、拒绝社交，只做练习后的身体觉察与档案记录。
* **目标用户**：有 3 年以上练习经验或长期坚持的资深阿斯汤加练习者（非新手）。

---

## 2. 页面架构与交互逻辑

### A. 首页：静谧的起点 (Practice)

* **视觉中心**：一个半透明磨砂质感的大圆按钮，在计时过程中会随 **Ujjayi 呼吸频率**（4-6秒/周期）缓慢放大与缩小，提供微弱的节奏引导。
* **快捷选择（按钮上方）**：
* 一序列 Mysore
* 半序列 Mysore
* 一序列口令课 (Led Class)
* 自定义 (Custom)


* **操作逻辑**：点击序列 -> 点击开始 -> 进入专注计时界面 -> 长按结束。

### B. 记录页：练习档案时间线 (Timeline)

* **布局逻辑**：采用“左日期、右内容”的档案式布局，让练习的厚度可视化。
* **左侧 (Date)**：显示具体日期和星期。
* **右侧 (Card)**：
* **练习元数据**：序列名称、精准练习时长。
* **成就标记 (Star)**：如果当日勾选了“突破时刻”，显示一个醒目的星星图标。
* **日记文字**：今日练习的身体觉察与感悟。
* **图片与 #Tag**：展示一张照片，并附带 `#体式名` 或 `#位置` 标签，方便后续通过标签筛选。



### C. 个人页：数据中心 (Me)
* **用户资料**：头像名字等基本信息
* **订阅管理**：管理 3 元/月或 30 元/年的订阅状态。
* **统计数据**：累计练习天数、累计练习总时长。
* **练习热力图**：展示一年内的练习分布，颜色深浅代表练习时长，让用户看到“复利”的痕迹。


---

## 3. 功能详情清单

| 功能 | 详情描述 | v1 版本状态 |
| --- | --- | --- |
| **精准计时** | 开始/结束手动触发，支持不锁屏下的呼吸灯动效。 | ✅ 核心功能 |
| **成就时刻** | 记录中的一个开关，标记今日是否有突破（如绑手、新体式）。 | ✅ 核心功能 |
| **#Tag 系统** | 上传图片时可自定义或选择标签，用于后续体式对比。 | ✅ 核心功能 |
| **补录功能** | 忘记计时时，允许手动添加日期、时长和序列。 | ✅ 核心功能 |
| **月相系统** | 自动标注 Moon Day 休息日，热力图特殊底纹。 | ⏳ 待开发 (v2) |
| **成就墙** | 汇总所有勾选了星星的里程碑时刻。 | ⏳ 待开发 (v2) |

---

## 4. 负向功能清单 (Why Not)

* **❌ 教学视频/音频**：用户是资深练习者，不需要在打卡工具里看视频。
* **❌ 大休息计时器**：练习结束已包含大休息，且练习场景多为多人教室，不宜频繁操作手机。
* **❌ 锁屏实时活动**：为了保持练习的绝对专注，减少手机消息干扰。
* **❌ 身体地图/量化指标**：身体感觉是复杂的，文字日记比生硬的打分更具深度。
* **❌ 社交排行榜**：瑜伽是内观的修行，不需要与他人竞争。

---

## 5. 商业模式与验证计划

### 商业模式

* **定价**：3 元/月 | 30 元/年（订阅制）。
* **收费逻辑**：核心计时功能免费；图片 #Tag 筛选、多图存储及未来的成就墙属于订阅功能。

### Week 1 验证标准 (Success Signals)

* **小红书测试**：发布包含“Timeline 档案感布局”和“呼吸感计时”的 UI 截图，收藏数 > 50。
* **用户反馈**：在调研的 10 个练习者中，超过 3 人表示愿意为“体式 #Tag 存档”付费。
* **自我验证**：Orange 自己用 Excel 模拟 Timeline 记录一周，确认“左日期、右日记”的模式确实能产生觉察。

---
---

## 开发日志

### 2026-01-25: 新用户教程记录系统 ✅

**目标**: 为新用户提供使用教程和示范

**核心功能**:
- ✅ 首次访问时自动添加3条教程记录（通过usePracticeData初始化）
- ✅ 修复练习类型显示：从数字ID改为完整字符串
- ✅ 教程日期使用固定日期：2026年1月1/7/10号

**3条教程记录**:

1. **首次练习教程**（2026-01-01）
   - 类型：一序列 Mysore
   - 时长：90分钟
   - 内容：🎉 开始记录你的阿斯汤加之旅！
     - 📝 如何记录觉察：身体感受、呼吸起伏、内心念头
     - 💡 小贴士：点击记录可以编辑或分享，完整编辑点击左侧区域

2. **突破时刻示范**（2026-01-07）
   - 类型：一序列 Led class
   - 时长：120分钟
   - 内容：🧘‍♂️ 今天的练习特别流畅，体式有了新的突破。超级开心
     - 🌟 突破时刻功能：记录里程碑、激励自己
     - 突破时刻：马里奇D终于可以自己绑上了

3. **休息日记录示范**（2026-01-10）
   - 类型：休息日 满月/新月
   - 时长：0分钟（不显示）
   - 内容：🌙 休息日也是练习的一部分。
     - 📖 如何记录休息日：恢复状况、期待、观察变化
     - 💤 休息是为了更好的练习，给身体时间成长

**技术实现**:
```typescript
// hooks/usePracticeData.ts - useEffect初始化
const storedRecords = localStorage.getItem('ashtanga_records');
if (!storedRecords || storedRecords === '[]') {
  const tutorialRecords: PracticeRecord[] = [
    {
      id: `tutorial-${Date.now()}-1`,
      created_at: now,
      date: '2026-01-01',
      type: '一序列 Mysore', // 完整字符串
      duration: 5400,
      notes: '🎉 开始记录你的阿斯汤加之旅！...',
      photos: []
    },
    // ... 其他2条记录
  ];
  setRecords(tutorialRecords);
}
```

**问题修复**:
1. ❌ 练习类型显示为数字（'1', '6'）
   - 原因：使用了option ID而非完整显示字符串
   - 解决：type使用完整字符串（如"一序列 Mysore"）
   - 结果：getTypeDisplayName自动截取显示"一序列"和"休息日"

2. ❌ 教程记录日期为当天
   - 原因：使用 `new Date().toISOString().split('T')[0]`
   - 解决：改为固定日期（2026-01-01, 2026-01-07, 2026-01-10）

3. ❓ 休息日时长为空
   - 结论：正常行为，duration=0时不显示（代码判断）

**时光轴间距问题**:
- 用户反馈：两条笔记之间间隔太近，文案连在一起
- 探索结果：记录之间没有垂直间距（motion.div无mb/mt类名）
- 建议：暂时不修改，等待用户实际使用反馈
- 方案：条件性间距（有内容时加间距，无内容时紧凑）

**练习备注显示问题**:
- 用户问题：练习类型下面要不要加上练习选项的备注？
- 分析：左侧列宽度只有70px，类型字体10px，不适合显示notes
- 建议：保持现有布局，不显示notes

**Git提交**:
- `5de6d73` - feat: 为新用户添加3条教程觉察记录
- `9354b13` - fix: 修复教程记录显示问题（练习类型和日期）

**部署状态**: ✅ 已推送到GitHub，Vercel自动部署完成

**用户体验**:
- 新用户首次进入tab1看到3条教程记录
- 点击记录可查看完整内容、编辑或删除
- 按照教程格式添加自己的练习

**下一步**:
- 继续使用和测试，发现其他问题
- P1: 照片上传功能（Supabase Storage）

**产品决策**: 符合"简单"理念，教程记录自动初始化，无需手动添加示范数据

---

### 2026-01-25: PWA原生应用封装完成 ✅

**目标**: 将Webapp封装为可安装的原生应用，无需应用商店审核

**核心功能**:
- ✅ PWA配置完成（manifest.json + Service Worker）
- ✅ Tab3添加PWA安装引导Banner（固定显示）
- ✅ Tab3左上角添加安装图标（点击触发）
- ✅ 智能检测用户系统和浏览器
- ✅ 根据系统+浏览器显示对应安装指引

**PWA特性**:
- 可安装到主屏幕，全屏运行，无浏览器地址栏
- 支持离线使用（Service Worker缓存）
- 图标：1024x1024全绿色icon.png
- 主题色：#4a7c59（绿色）

**安装指引**（Android）:
```
💡 安装到主屏幕方法
Chrome浏览器：点击右上角→ 选择添加到主屏幕
Edge浏览器：点击右下角→ 选择添加到手机
安装后可像App一样使用，获得最佳体验。
```

**技术实现**:
- `public/manifest.json` - PWA配置文件
- `public/sw.js` - Service Worker（离线缓存）
- `components/ServiceWorkerRegister.tsx` - 注册组件
- `components/PWAInstallBanner.tsx` - Banner组件
- `hooks/usePWAInstall.ts` - 安装逻辑hook

**浏览器兼容性**:
- 支持：Chrome、Safari、Edge、Samsung Internet
- 不支持：夸克、UC、小米、华为（不显示引导）

**Git提交**: 17个提交（fde2475 → 9d50e7c）

**部署状态**: ✅ 已推送到GitHub，Vercel自动部署完成

**用户体验**: 
- 两个提示入口（Banner固定 + Toast点击）
- 文案统一，覆盖主流浏览器
- 一键安装，无需审核，跨平台（iOS+Android）

**下一步**: 继续使用和测试，发现问题

---
